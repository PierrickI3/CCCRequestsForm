<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
    <title>CC Rapid Response Request Form</title>
    <link rel="shortcut icon" href="/favicon.ico">
    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- Bootstrap DatePicker -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker3.min.css" integrity="sha256-FAOaXTpl90/K8cXmSdsskbQN3nKYulhCpPbcFzGTWKI=" crossorigin="anonymous" />
    <!-- jQuery Toast -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/jquery-toast-plugin/1.3.2/jquery.toast.min.css" rel="stylesheet">
    <!-- Bootstrap Select -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.9/dist/css/bootstrap-select.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="./css/custom.css">

</head>

<body>
    <img class="overlay" src="./images/devmode.png" id="devModeImage" hidden alt="devMode" />
    <nav class="navbar navbar-dark bg-dark">
        <a class="navbar-brand" href="#">
            <img src="images/genesys.png" width="30" height="30" class="d-inline-block align-top" alt="">
            <span class="badge badge-warning">#rapidresponse</span> Request Form <small><span class="badge badge-pill badge-warning" id="regionBadge"></span></small>
        </a>

        <ul class="mb-0">
            <ul class="nav navbar-nav" style="float: right;">
                <li>
                    <a href="#" id="reviewRequestsButton" class="admin btn btn-primary btn-sm" hidden>Review Requests</a>
                </li>

            </ul>
            <ul class="nav navbar-nav mr-2" style="float: right;">
                <li>
                    <a href="../index.html" id="backToCCCRequestForm" class="btn btn-secondary btn-sm">Back to CC Request Form</a>
                </li>

            </ul>

        </ul>

    </nav>

    <div class="alert alert-danger fade show" role="alert" id="alert" hidden>
        <strong>Maintenance Alert</strong> This site is being updated. Please wait.
        <a class="btn btn-light" href="#" onclick="location.reload();"><i class="fa fa-refresh"></i> Refresh</a>
    </div>

    <div id="form" class="container-fluid">
        <br>
        <div class="form-row">
            <div class="form-group">
                <H3 class="text-center">Welcome to the Rapid Response Request Form</H3>
                <hr>
                <p>This is designed to be a 90 day Emergency Solution. <em>It is not designed to be a replication of what existing customers have today</em></p>

                <p>Our COVID-19 offer for 3 months free use of Genesys Cloud is only available to <span class="bg-warning">existing customers</span> in good standing (Direct or Indirect). Direct existing customers will get free PS services as per our defined package. Indirect existing customers via partners will get benefit of COVID-19 commercial offer, but they will have to deliver PS services on their own (exceptions require approval).</p>
                <p>WebRTC should be used unless there are special circumstances preventing this. User bandwidth is expected to be in high demand due to additional family members consuming services, e.g. Video on Demand, Gaming, etc. Customers should perform "spot-tests" on as many home workers as possible using the Genesys Network Assessment Tool. IVRs will be limited to simple call handling trees for routing and skill identification will be included. CRM integration, as well as other back integrations, will not be part of this deployment</p>
                <p>Number porting is not possible with this offer. Corporate VPN’s may require additional technical investigation and configuration.</p>
                <p>Genesys supports:
                    <ul>
                        <li>Forwarding of existing numbers to Genesys Cloud Voice</li>
                        <li>Provisioning of new numbers with Genesys Cloud Voice</li>
                        <li>SIP trunk connections to existing infrastructure (BYOC Cloud)</li>
                        <li>SIP trunks direct to carriers (BYOC Cloud)</li>
                    </ul>
                </p>

                <form id="mainform">

                    <!--#region Telephony -->

                    <div class="col-md-12 bg-light shadow">
                        <hr />
                        <h3 class="text-center">Telephony</h3>
                        <hr />
                    </div>

                    <!-- Countries & Languages -->
                    <div class="form-row mr-4 ml-2">
                        <div class="form-group col-md-6">
                            <label for="countriesAgents">In which countries are the customer's agents located? <span class="text-danger font-weight-bold">*</span></label>
                            <select class="selectpicker" id="countriesAgents" name="countriesAgents" class="form-control" required multiple data-live-search="true">
                            </select>
                        </div>
                        <div class="form-group col-md-6">
                            <label for="countriesOperation">In which countries does the customer operate and require (or have existing) phone numbers? <span class="text-danger font-weight-bold">*</span></label>
                            <select class="selectpicker" id="countriesOperation" name="countriesOperation" class="form-control" required multiple data-live-search="true">
                            </select>
                        </div>
                    </div>

                    <!-- Telephony Model -->

                    <div class="text-muted form-group ml-3">
                        <small>Where a SIP trunk cannot be easily established, it is recommended to use Genesys Cloud Voice and forwarding of calls.</small>
                    </div>

                    <div class="form-group col-md-6">
                        <div class="text-muted" id="recommendation">
                        </div>
                        <label for="telephonyModel">Telephony Model <span class="text-danger font-weight-bold">*</span></label>
                        <select id="telephonyModel" name="telephonyModel" class="form-control" required>
                            <option value="" disabled selected>Select a Telephony Model</option>
                        </select>
                    </div>

                    <!-- GCV Questions -->
                    <div id="GCVQuestions" style="display:none;">

                        <!-- Phone Numbers Deployment -->
                        <div class="form-row mr-4 ml-2">
                            <div class="form-group col-md-12">
                                <label for="phoneNumbersDeployment">Phone Numbers Deployment <span class="text-danger font-weight-bold">*</span></label>
                                <textarea class="form-control" id="phoneNumbersDeployment" name="phoneNumbersDeployment" placeholder="Will the customer deploy new customer-facing numbers from GCV, re-route non-geographic numbers to GCV or forward calls to GCV numbers?"></textarea>
                                Genesys Cloud Voice (Resource Center): <a href="https://help.mypurecloud.com/articles/about-purecloud-voice/" target="_blank">https://help.mypurecloud.com/articles/about-purecloud-voice/</a>
                            </div>
                        </div>

                        <!-- New Numbers -->
                        <div class="form-row mr-4 ml-2">
                            <div class="form-group col-md-12">
                                <label for="newNumbers">New Numbers <span class="text-danger font-weight-bold">*</span></label>
                                <textarea class="form-control" id="newNumbers" name="newNumbers" placeholder="If using new numbers, how many of each number type and which area codes are required?"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- BYOC Cloud Carriers -->
                    <div class="border border-black mr-3 col-md-6" id="byocCloudCarriersDiv" style="display: none;">
                        <div class="form-row mt-1 mr-4 ml-2">
                            <div class="form-group col-md-5 text-center">Country</div>
                            <div class="form-group col-md-5 text-center">Select one or more Carriers <span class="text-danger font-weight-bold">*</span></div>
                        </div>
                        <div class="form-row mt-2 mr-4 ml-2" id="byocCloudCarriers"></div>
                        <small id="otherNote" class="form-group ml-2">
                            If you have selected "Other":
                            <ul>
                                <li>Carrier must meeting standard requirements as per Resource Centre: <a href="https://help.mypurecloud.com/articles/carrier-requirements-byoc-cloud/" target="_blank">https://help.mypurecloud.com/articles/carrier-requirements-byoc-cloud/</a></li>
                                <li>Expectation that deployment time will be extended, <strong>in most cases significantly</strong></li>
                            </ul>
                        </small>
                        <div class="form-check mr-4">
                            <div class="form-group col-md-12">
                                <input class="form-check-input" type="checkbox" value="" id="relationshipWithCarrier">
                                <label class="form-check-label" for="relationshipWithCarrier">
                                    Does the customer already have a relationship with the carrier and access to technical resources?
                                </label>
                            </div>
                        </div>

                        <!-- Phone Numbers Deployment -->
                        <div class="form-check mr-4">
                            <div class="form-group col-md-12">
                                <input class="form-check-input" type="checkbox" value="" id="existingTelephonyUsage">
                                <label class="form-check-label" for="existingTelephonyUsage">
                                    Is the customer connecting to a PBX, SBC or intending to have a direct carrier connection?
                                </label>
                                <br>
                            </div>
                        </div>

                        <div class="form-row col-md-12">
                            <div class="form-group col-md-12">
                                <textarea class="form-control" id="existingTelephonyUsageDetails" name="existingTelephonyUsageDetails" placeholder="Please provide more details..." disabled></textarea>
                            </div>
                        </div>
                    </div>


                    <!-- BYOC Cloud Questions -->
                    <div id="BYOCCloudQuestions" style="display:none;">
                    </div>

                    <!-- BYOC Premise with Virtual Edges -->
                    <div class="border border-black mr-3 ml-2 bg-warning" id="byocPremiseDiv" style="display: none;">
                        <p class="form-group ml-2">
                            If planning to use a virtual edge, very strict guidelines for deployment must be followed:
                            <ul>
                                <li>Virtual Edge Hardware/Software Requirements: <a href="https://help.mypurecloud.com/articles/virtual-edge-hardware-software-requirements/" target="_blank">https://help.mypurecloud.com/articles/virtual-edge-hardware-software-requirements/</a></li>
                                <li>Virtual Edge Warnings: <a href="https://help.mypurecloud.com/articles/virtual-edge-warnings/" target="_blank">https://help.mypurecloud.com/articles/virtual-edge-warnings/</a></li>
                            </ul>
                        </p>
                        <p class="form-group ml-2">
                            The customer must acknowledge that failing to comply with the requirements and warnings will result in possible audio quality issues.
                        </p>
                    </div>

                    <!-- BYOC Premise Questions -->
                    <div id="BYOCPremiseQuestions" class="mt-2" style="display:none;">

                        <!-- Virtual Environment -->
                        <div class="form-check mr-4">
                            <div class="form-group col-md-12">
                                <input class="form-check-input" type="checkbox" value="" id="hyperVEnvironment">
                                <label class="form-check-label" for="hyperVEnvironment">
                                    Does the customer have a Hyper-V environment available?
                                </label>
                                <br>
                            </div>
                        </div>

                    </div>

                    <!--#endregion Telephony -->

                    <!--#region Configuration -->

                    <div class="col-md-12 bg-light shadow">
                        <hr />
                        <h3 class="text-center">General Configuration</h3>
                        <hr />
                    </div>

                    <!-- Concurrent Calls -->
                    <div class="form-row mr-4 ml-2">
                        <div class="form-group col-md-12">
                            <label for="numberConcurrentCalls">What is the expected number of concurrent calls? <span class="text-danger font-weight-bold">*</span></label>
                            <textarea class="form-control" id="numberConcurrentCalls" name="numberConcurrentCalls" placeholder="" required></textarea>
                        </div>
                    </div>

                    <!-- Identification and Verification -->
                    <div class="form-row mr-4 ml-2">
                        <div class="form-group col-md-12">
                            <label for="identificationAndVerificationProcesses">Identity and Verification Processes <span class="text-danger font-weight-bold">*</span></label>
                            <textarea class="form-control" id="identificationAndVerificationProcesses" name="identificationAndVerificationProcesses" placeholder="Are there any mandatory Identification and Verification processes?" required></textarea>
                        </div>
                    </div>

                    <!-- IT Infrastructure -->
                    <div class="form-row mr-4 ml-2">
                        <div class="form-group col-md-12">
                            <label for="itInfrastructure">IT Infrastructure <span class="text-danger font-weight-bold">*</span></label>
                            <textarea class="form-control" id="itInfrastructure" name="itInfrastructure" placeholder="Is the IT infrastructure supported in-house or via a third-party, including internet connections, user/company provided laptops and headsets?" required></textarea>
                        </div>
                    </div>

                    <!-- Network Assessment Tool -->
                    <div class="form-check mr-4">
                        <div class="form-group col-md-12">
                            <input class="form-check-input" type="checkbox" value="" id="networkAssessmentTool">
                            <label class="form-check-label" for="networkAssessmentTool">
                                Has the customer run the network assessment tool on multiple home workers to ensure they can connect successfully to Genesys Cloud?
                            </label>
                        </div>
                    </div>

                    <!-- Internet Bandwidth -->
                    <div class="form-check mr-4">
                        <div class="form-group col-md-12">
                            <input class="form-check-input" type="checkbox" value="" id="usersInternetBandwidth">
                            <label class="form-check-label" for="usersInternetBandwidth">
                                Do users have sufficient internet bandwidth for the intended use, noting high bandwidth demand from other family members etc.?
                            </label>
                        </div>
                    </div>

                    <!-- End devices require VPN? -->
                    <div class="form-check mr-4">
                        <div class="form-group col-md-12">
                            <input class="form-check-input" type="checkbox" value="" id="endUserDevicesRequireVPN">
                            <label class="form-check-label" for="endUserDevicesRequireVPN">
                                Are user end-devices required to connect via VPN?
                            </label>
                        </div>
                    </div>

                    <!-- Virtual Solution -->
                    <div class="form-row mr-4 ml-2">
                        <div class="form-group col-md-12">
                            <label for="virtualDesktopSolution">Virtual Desktop Solution <span class="text-danger font-weight-bold">*</span></label>
                            <textarea class="form-control" id="virtualDesktopSolution" name="virtualDesktopSolution" placeholder="Does the customer use a Virtual Desktop solution, e.g. Citrix, thin-clients, etc.?" required></textarea>
                        </div>
                    </div>

                    <!-- Email Infrastructure -->
                    <div class="form-row mr-4 ml-2">
                        <div class="form-group col-md-12">
                            <label for="emailInfrastructure">Email Infrastructure</label>
                            <textarea class="form-control" id="emailInfrastructure" name="emailInfrastructure" placeholder="What is the existing email infrastructure and can it be modified to use a company domain email address?"></textarea>
                        </div>
                    </div>

                    <!--#endregion -->

                    <!--#region PS Engagement -->

                    <div class="col-md-12 bg-light shadow">
                        <hr />
                        <h3 class="text-center">PS Engagement</h3>
                        <hr />
                    </div>

                    <!-- Commmitted Customer Resource -->
                    <div class="form-check mr-4">
                        <div class="form-group col-md-12">
                            <input class="form-check-input" type="checkbox" value="" id="customerResourceCommitted">
                            <label class="form-check-label" for="customerResourceCommitted">
                                Have customer resources been committed (e.g. Project Manager, Project Sponsor, Business Champion and/or IT/Operations Manager, etc.)?
                            </label>
                        </div>
                    </div>

                    <!-- Call Flows -->
                    <div class="form-check mr-4">
                        <div class="form-group col-md-12">
                            <input class="form-check-input" type="checkbox" value="" id="callFlowsDocumented">
                            <label class="form-check-label" for="callFlowsDocumented">
                                Are the required call flows documented?
                            </label>
                        </div>
                    </div>

                    <!-- Email Flow -->
                    <div class="form-check mr-4">
                        <div class="form-group col-md-12">
                            <input class="form-check-input" type="checkbox" value="" id="emailFlowDocumented">
                            <label class="form-check-label" for="emailFlowDocumented">
                                Is the email flow documented? (optional)
                            </label>
                        </div>
                    </div>

                    <!-- Prompts -->
                    <div class="form-check mr-4">
                        <div class="form-group col-md-12">
                            <input class="form-check-input" type="checkbox" value="" id="promptsAvailable">
                            <label class="form-check-label" for="promptsAvailable">
                                Is the customer able to supply audio prompt/announcement files? If these are not available, TTS will be used.
                            </label>
                        </div>
                    </div>

                    <!-- PS File -->
                    <div class="mr-4 ml-3 mb-5">
                        Click <a href="./files/PS Discovery Questionnaire RR v1.2.xlsx" target="_blank">here</a> to download a copy of the PS Questionnaire.
                        <br>
                        Click <a href="./files/PS DIscovery Questionnaire RR v1.1.docx" target="_blank">here</a> to download instructions on how to use the PS Questionnaire.
                        <br>
                        <p>To download the files from the <strong>Genesys Cloud app</strong>, press <span class="bg-warning">SHIFT</span> while clicking on each link.</p>
                        <em>Please inform the customer that this information is essential to complete the deployment of Genesys Cloud.</em>
                    </div>

                    <!--#endregion -->

                    <!--#region Policies & Processes -->

                    <div class="col-md-12 bg-light shadow">
                        <hr />
                        <h3 class="text-center">Policies & Processes</h3>
                        <hr />
                    </div>

                    <!-- Terms & Conditions -->
                    <div class="form-check mr-4">
                        <div class="form-group col-md-12">
                            <input class="form-check-input" type="checkbox" value="" id="standardTermsConditions">
                            <label class="form-check-label" for="standardTermsConditions">
                                Has the customer agreed to our standard Terms and Conditions and DPA?
                            </label>
                        </div>
                    </div>

                    <!-- Off-Boarding Policy -->
                    <div class="form-check mr-4">
                        <div class="form-group col-md-12">
                            <input class="form-check-input" type="checkbox" value="" id="offBoardingPolicy">
                            <label class="form-check-label" for="offBoardingPolicy">
                                Does the customer understand and agree to our off-boarding policy of Data Deletion or Data Download as per the standard Terms and Conditions?
                            </label>
                        </div>
                    </div>

                    <!-- Change Management Process Delays -->
                    <div class="form-check mr-4">
                        <div class="form-group col-md-12">
                            <input class="form-check-input" type="checkbox" value="" id="changeManagementProcessDelays">
                            <label class="form-check-label" for="changeManagementProcessDelays">
                                Does the customer accept that Genesys will not be held responsible for any delays caused by the customer change management process?
                            </label>
                        </div>
                    </div>

                    <!--#endregion -->

                    <!--#region Your Info -->

                    <!-- Requester Info -->
                    <div class="col-md-12 bg-light shadow">
                        <h3 class="text-center">Your Info</h3>
                        <hr />
                    </div>

                    <!-- Region and Territory -->
                    <div class="form-row mr-4 ml-2">
                        <div class="form-group col-md-6">
                            <label for="region">Region <span class="text-danger font-weight-bold">*</span></label>
                            <select id="region" name="region" class="form-control" required>
                                <option value="" disabled selected>Select your Region</option>
                                <option value="APAC">APAC</option>
                                <option value="EMEA">EMEA</option>
                                <option value="LATAM">LATAM</option>
                                <option value="NA">North America</option>
                            </select>
                        </div>
                        <div class="form-group col-md-6">
                            <label for="subRegion">Territory <span class="text-danger font-weight-bold">*</span></label>
                            <select id="subRegion" name="subRegion" class="form-control" required>
                                <option value="" disabled selected>Select your Territory</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row mr-4 ml-2">
                        <div class="form-group col-md-6">
                            <label for="requesterName">Requester Name <span class="text-danger font-weight-bold">*</span></label>
                            <input type="text" class="form-control" id="requesterName" name="requesterName" placeholder="Your Name" required>
                        </div>
                        <div class="form-group col-md-6">
                            <label for="requesterEmail">Requester Email <span class="text-danger font-weight-bold">*</span></label>
                            <input type="text" class="form-control" id="requesterEmail" name="requesterEmail" placeholder="Your Email Address" required>
                        </div>
                    </div>

                    <div class="form-row mr-4 ml-2">
                        <div class="form-group col-md-6">
                            <label for="requesterPhoneNumber">Requester Phone # <span class="text-danger font-weight-bold">*</span></label>
                            <input type="text" class="form-control" id="requesterPhoneNumber" name="requesterPhoneNumber" placeholder="Your Phone Number" required>
                        </div>
                        <div class="form-group col-md-6">
                            <label for="datepicker">Need Completed By <span class="text-danger font-weight-bold">*</span></label>
                            <input type="text" id="datepicker" class="form-control" required placeholder="Click to set a date" autocomplete="off" />
                        </div>
                    </div>

                    <div class="form-row mr-4 ml-2">
                        <div class="form-group col-md-12">
                            <label for="notes">Notes/Comments <span class="text-danger font-weight-bold">*</span></label>
                            <textarea class="form-control" id="notes" name="notes" placeholder="Please add any useful notes and comments" required></textarea>
                        </div>
                    </div>

                    <div class="form-row mr-4 ml-2">
                        <div class="form-group col-md-6">
                            <label for="partnerCustomerName">Partner and/or Customer Name <span class="text-danger font-weight-bold">*</span></label>
                            <input type="text" class="form-control" id="partnerCustomerName" name="partnerCustomerName" placeholder="Partner and/or Customer Name" required>
                        </div>
                        <div class="form-group col-md-6">
                            <label for="salesforceAccountOpportunity">SF Account / Opportunity URL</label>
                            <input type="text" class="form-control" id="salesforceAccountOpportunity" name="salesforceAccountOpportunity" placeholder="Link to Salesforce opportunity or account">
                        </div>
                    </div>

                    <!--#endregion Your Info -->

                </form>

                <br>
                <button type="submit" id="submit" class="btn btn-primary ml-3" disabled>Submit</button>

            </div>
        </div>
    </div>


    <noscript>You need to enable JavaScript to run this app.</noscript>
    <!--#region Imports -->
    <!-- Bootstrap core JavaScript-->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>
    <!-- Core plugin JavaScript-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>
    <!-- Moment.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js" integrity="sha256-4iQZ6BVL4qNKlQ27TExEhBN1HFPvAvAMbFavKKosSWQ=" crossorigin="anonymous"></script>
    <!-- Bootstrap DatePicker -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js" integrity="sha256-bqVeqGdJ7h/lYPq6xrPv/YGzMEb6dNxlfiTUHSgRCp8=" crossorigin="anonymous"></script>
    <!-- Genesys Cloud -->
    <script src="https://sdk-cdn.mypurecloud.com/javascript/61.0.0/purecloud-platform-client-v2.min.js"></script>
    <!-- JQuery Validate -->
    <script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.1/dist/jquery.validate.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.1/dist/additional-methods.min.js"></script>
    <!-- jQuery Toast -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-toast-plugin/1.3.2/jquery.toast.min.js"></script>
    <!-- Bootstrap Select -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.9/dist/js/bootstrap-select.min.js"></script>
    <!-- Our Scripts -->
    <script src="js/gc.js"></script>
    <script src="js/requests.js"></script>
    <script src="js/tools.js"></script>
    <!-- Dictionary -->
    <script src="js/dictionary.js"></script>

    <!--#endregion -->

    <script>
        let countriesAndCarriers = [], countryCarrierId = 0, gcToken, selectedCountries = [];

        if (maintenanceMode) {
            $("#alert").attr("hidden", false);
            $("#form :input").attr("disabled", true);
            $("#form :button").attr("disabled", true);
        } else {
            //addNewTask(false);
        }

        if (window.location.href.includes('dev')) {
            $("#devModeImage").removeAttr('hidden');
        }

        // Populate countries selects
        $.each(countries, (i, country) => {
            $("<option/>", { value: country.name, ["data-gcv"]: country.gcv }).text(country.name).appendTo("#countriesAgents, #countriesOperation");
        });

        // Populate telephonyModel selects from dictionary
        $.each(telephonyModel, (key, value) => {
            $("<option/>", { value: key }).text(value).appendTo("#telephonyModel");
        });

        $("#countriesAgents").selectpicker({
            width: '100%',
            selectedTextFormat: 'count > 3',
            title: "Select one or more countries"
        });

        $("#countriesOperation").selectpicker({
            width: '100%',
            selectedTextFormat: 'count > 3',
            title: "Select one or more countries"
        });

        $("#countriesOperation").on('change', (e) => {
            selectedCountries = [];
            $.each($("#countriesOperation").val(), (i, selectedCountry) => {
                selectedCountries.push({
                    name: selectedCountry,
                    gcv: $(`#countriesOperation option[value="${selectedCountry}"]`).attr('data-gcv') == "true" || false
                });
            });
            console.log(selectedCountries);
            refreshBYOCCloudCountryCarriers();
            setTelephonyModel();
        });

        $("#existingTelephonyUsage").on('change', () => {
            $("#existingTelephonyUsageDetails").attr('disabled', !$("#existingTelephonyUsage").is(":checked"));
        });

        function setTelephonyModel() {
            let gcvSupported = selectedCountries.length > 0 && selectedCountries.every(c => c.gcv);
            if (gcvSupported) {
                if (!$("#existingTelephonyUsage").is(":checked")) {
                    $("#telephonyModel").val('GCV');
                    $("#telephonyModel").change();
                    $("#recommendation").empty();
                    $("<small/>", { class: "btn-warning" }).html(`Based on your selection of countries, <strong>${$("#telephonyModel option:selected").text()}</strong> is the recommended choice`).appendTo("#recommendation")
                } else {
                    $("#telephonyModel").val('BYOCCloud');
                    $("#telephonyModel").change();
                    $("#recommendation").empty();
                    $("<small/>", { class: "btn-warning" }).html(`Based on your selection of countries, <strong>${$("#telephonyModel option:selected").text()}</strong> is the recommended choice`).appendTo("#recommendation")
                }
            } else {
                $("#telephonyModel").val('BYOCCloud');
                $("#telephonyModel").change();
                $("#recommendation").empty();
                //$("<small/>", { class: "btn-warning" }).html(`Based on your selection of countries, <strong>${$("#telephonyModel option:selected").text()}</strong> is the recommended choice`).appendTo("#recommendation")
            }
        }

        $("#telephonyModel").on('change', (e) => {
            switch ($("#telephonyModel").val()) {
                case 'GCV':
                    $("#byocCloudCarriersDiv").hide();
                    $("#byocPremiseDiv").hide();
                    countriesAndCarriers = [];
                    $("#GCVQuestions").show();
                    $("#BYOCCloudQuestions").hide();
                    $("#BYOCPremiseQuestions").hide();
                    break;
                case 'BYOCCloud':
                    if (!$("#countriesOperation").val() || $("#countriesOperation").val().length === 0) {
                        $("#telephonyModel").val('');
                        showMessage('Please select at least one country where the customer operates first', true);
                        return;
                    }
                    refreshBYOCCloudCountryCarriers();
                    $("#byocCloudCarriersDiv").show();
                    $("#byocPremiseDiv").hide();
                    $("#GCVQuestions").hide();
                    $("#BYOCPremiseQuestions").hide();
                    $("#phoneNumbersDeployment").val('');
                    $("#BYOCCloudQuestions").show();
                    break;
                case 'BYOCPremiseWithVirtualEdges':
                    $("#byocCloudCarriersDiv").hide();
                    $("#GCVQuestions").hide();
                    $("#byocPremiseDiv").show();
                    countriesAndCarriers = [];
                    $("#GCVQuestions").hide();
                    $("#phoneNumbersDeployment").val('');
                    $("#BYOCCloudQuestions").hide();
                    $("#BYOCPremiseQuestions").show();
                    break;
                default:
                    $("#byocCloudCarriersDiv").hide();
                    $("#byocPremiseDiv").hide();
                    countriesAndCarriers = [];
                    $("#GCVQuestions").hide();
                    $("#phoneNumbersDeployment").val('');
                    $("#BYOCCloudQuestions").hide();
                    $("#BYOCPremiseQuestions").hide();
                    break;
            }
        });

        // Init DatePicker
        $(function () {
            $("#datepicker").datepicker({
                daysOfWeekDisabled: "0,6",
                todayHighlight: true,
                autoclose: true,
                startDate: new Date()
            });
        });

        init();
        async function init() {

            try {
                await getMe();
                if (!maintenanceMode) $("#submit").attr('disabled', false);
            } catch (error) {
                showMessage(error.hasOwnProperty('message') ? error.message : `Unable to login to Genesys Cloud ${JSON.stringify(error)}`, true);
                $("#submit").attr('disabled', true);
                return
            }

            gcToken = userInfo.token
            localStorage.setItem("gcToken", gcToken);
            localStorage.setItem("userName", userInfo.name);

            // Populate user info
            $("#requesterName").val(userInfo.name);
            $("#requesterEmail").val(userInfo.mail);
            $("#requesterPhoneNumber").val(userInfo.phone);

            loadDraft();

            // Show Admin fields?

            if (userInfo.groups.some(g => adminGroups["super"].includes(g))) {
                console.log('Show super admin stuff')
                $(".admin").show();
                $(".admin").removeAttr('hidden');
                $("#reviewRequestsButton").attr("href", "requests.html?region=super-user");
                $("#regionBadge").text('super-user');
            } else if (userInfo.groups.some(g => adminGroups["EMEA"].includes(g))) {
                console.log('Show admin stuff')
                $(".admin").show();
                $(".admin").removeAttr('hidden');
                $("#reviewRequestsButton").attr("href", "requests.html?region=EMEA");
                $("#regionBadge").text('EMEA');
            } else if (userInfo.groups.some(g => adminGroups["NA"].includes(g))) {
                console.log('Show admin stuff')
                $(".admin").show();
                $(".admin").removeAttr('hidden');
                $("#reviewRequestsButton").attr("href", "requests.html?region=NA");
                $("#regionBadge").text('NA');
            } else if (userInfo.groups.some(g => adminGroups["APAC"].includes(g))) {
                console.log('Show admin stuff')
                $(".admin").show();
                $(".admin").removeAttr('hidden');
                $("#reviewRequestsButton").attr("href", "requests.html?region=APAC");
                $("#regionBadge").text('APAC');
            } else if (userInfo.groups.some(g => adminGroups["LATAM"].includes(g))) {
                console.log('Show admin stuff')
                $(".admin").show();
                $(".admin").removeAttr('hidden');
                $("#reviewRequestsButton").attr("href", "requests.html?region=LATAM");
                $("#regionBadge").text('LATAM');
            } else {
                console.log('Hide admin stuff')
                $(".admin").hide();
                $(".admin").attr('hidden', true);
                $("#regionBadge").text('');
                $("#reviewRequestsButton").hide();
            }
        }

        function refreshBYOCCloudCountryCarriers() {
            let currentCountryCarrierId = countryCarrierId++;

            $("#byocCloudCarriers").empty();
            if (countriesAndCarriers.length == 0) {

                $.each($("#countriesOperation").val(), (i, country) => {

                    // Country
                    let countryDiv = $("<div/>", { class: "form-group col-md-5" }).appendTo("#byocCloudCarriers");
                    $("<label/>", { id: "country_" + country }).text(country).appendTo(countryDiv);

                    // Carriers
                    let carriersDiv = $("<div/>", { class: "form-group col-md-5" }).appendTo("#byocCloudCarriers");
                    let carriersSelect = $("<select/>", { class: "selectpicker form-control", id: "carriers_" + country, name: "carriers_" + country, ["data-live-search"]: true, required: true, multiple: true }).appendTo(carriersDiv);
                    //$("<option/>", { value: "", disabled: true }).text("Select a Carrier").appendTo(carriersSelect);
                    $.each(supportedBYOCCloudCarriers, (region, regionalSupportedBYOCCloudCarriers) => {
                        let optGroup = $("<optgroup/>", { label: region }).appendTo(carriersSelect);
                        $.each(regionalSupportedBYOCCloudCarriers, (i, regionalSupportedBYOCCloudCarrier) => {
                            $("<option/>", { value: regionalSupportedBYOCCloudCarrier.name }).text(regionalSupportedBYOCCloudCarrier.name).appendTo(optGroup);
                        });
                    });
                    $("<option/>", { value: "Other" }).text("Other").appendTo(carriersSelect);
                    carriersSelect.selectpicker({
                        title: "Select one or more carriers"
                    });
                    carriersSelect.on('change', (e) => {
                        if (carriersSelect.val().includes("Other")) {
                            $("otherNote").show();
                        } else {
                            $("otherNote").hide();
                        }

                        let bFound = false;
                        for (var i in countriesAndCarriers) {
                            if (countriesAndCarriers[i].hasOwnProperty(country)) {
                                countriesAndCarriers[i] = {
                                    [country]: carriersSelect.val().join(',')
                                }
                                bFound = true;
                                break;
                            }
                        }
                        if (!bFound) {
                            // Add to array
                            countriesAndCarriers.push({
                                [country]: carriersSelect.val().join(',')
                            });
                        }

                    });
                });
            } else {
                $.each(countriesAndCarriers, (i, byocCloudCarrier) => {
                    console.log(i, byocCloudCarrier);
                    let country = Object.keys(byocCloudCarrier)[0];
                    let carriers = Object.values(byocCloudCarrier)[0].split(',');

                    // Country
                    let countryDiv = $("<div/>", { class: "form-group col-md-6" }).appendTo("#byocCloudCarriers");
                    $("<label/>", { id: "country_" + country }).text(country).appendTo(countryDiv);

                    // Carriers
                    let carriersDiv = $("<div/>", { class: "form-group col-md-6" }).appendTo("#byocCloudCarriers");
                    let carriersSelect = $("<select/>", { class: "selectpicker form-control", id: "carriers_" + country, name: "carriers_" + country, ["data-live-search"]: true, required: true, multiple: true }).appendTo(carriersDiv);
                    //$("<option/>", { value: "", disabled: true }).text("Select a Carrier").appendTo(carriersSelect);
                    $.each(supportedBYOCCloudCarriers, (region, regionalSupportedBYOCCloudCarriers) => {
                        let optGroup = $("<optgroup/>", { label: region }).appendTo(carriersSelect);
                        $.each(regionalSupportedBYOCCloudCarriers, (i, regionalSupportedBYOCCloudCarrier) => {
                            $("<option/>", { value: regionalSupportedBYOCCloudCarrier.name, selected: carriers.includes(regionalSupportedBYOCCloudCarrier.name) }).text(regionalSupportedBYOCCloudCarrier.name).appendTo(optGroup);
                        });
                    });
                    $("<option/>", { value: "Other", selected: carriers.includes('Other') }).text("Other").appendTo(carriersSelect);
                    carriersSelect.selectpicker({
                        title: "Select one or more carriers"
                    });
                    carriersSelect.on('change', (e) => {
                        let bFound = false;
                        for (var i in countriesAndCarriers) {
                            if (countriesAndCarriers[i].hasOwnProperty(country)) {
                                countriesAndCarriers[i] = {
                                    [country]: carriersSelect.val().join(',')
                                }
                                bFound = true;
                                break;
                            }
                        }
                        if (!bFound) {
                            // Add to array
                            countriesAndCarriers.push({
                                [country]: carriersSelect.val().join(',')
                            });
                        }

                    });
                });
            }
        }

        $("#region").on("change", () => {
            $("#subRegion").empty();
            for (let subregion of regions[$("#region").val()]) {
                $("<option/>", { value: subregion }).text(subregion).appendTo("#subRegion");
            }
        });

        $("#mainform").validate({
            errorClass: "text-danger",
            successClass: "test-success"
        });

        $("#submit").on("click", async (e) => {
            e.preventDefault();
            if (!$("#mainform").valid()) {
                showMessage("Missing or invalid fields", true);
                return;
            }

            try {
                // Disable submit button
                $("#submit").prop('disabled', true);
                $("#submit").html(
                    `<span class="spinner-border-sm text-light" role="status" aria-hidden="true"></span> Please Wait...`
                )

                await postRequests();
                console.log('Success!');
                showMessage("Request submitted. Thanks!");

                // Need completed by
                let needCompletedBy = "Not Set";
                let needCompletedByDate = moment($("#datepicker").datepicker('getDate')).format("YYYY-MM-DDT00:00:00.000");
                if (needCompletedByDate != "Invalid date") {
                    needCompletedBy = moment($("#datepicker").datepicker('getDate')).format("YYYY-MM-DDT00:00:00.000") + "Z";
                }

                let detailedInfo = "\n```no-highlight\n region:\t\t" + $("#region").val() + "\n sub-region:\t\t" + $("#subRegion").val() + "\n req name:\t\t" + $("#requesterName").val() + "\n req email:\t\t" + $("#requesterEmail").val() + "\n req phone:\t\t" + $("#requesterPhoneNumber").val() +
                    "\n completed by:\t\t" + needCompletedBy + "\n notes:\t\t" + $("#notes").val() + "\n p/c name:\t\t" + $("#partnerCustomerName").val() + "\n sf/acc opp:\t\t" + $("#salesforceAccountOpportunity").val() + "\n ```\n";
                if (!window.location.href.includes('localhost'))
                    sendNotification(`:loudspeaker: New CC Rapid Response Request from [@${userInfo.name}](#/person/${userInfo.id}) ${detailedInfo}`, $("#region").val(), $("#subRegion").val());

                cleanForm();
            } catch (error) {
                console.error(error);
                showMessage(error.hasOwnProperty('message') ? error.message : JSON.stringify(error, null, 2), true);
            } finally {
                // Enable button
                $("#submit").prop('disabled', false);
                $("#submit").html('Submit');
            }

        });

        function cleanForm() {

            // Telephony
            $("#countriesAgents").val('');
            $("#countriesAgents").selectpicker('refresh');
            $("#countriesOperation").val('');
            $("#countriesOperation").selectpicker('refresh');

            $("#existingTelephonyUsage").prop('checked', false);
            $("#existingTelephonyUsageDetails").val('');
            $("#telephonyModel")[0].selectedIndex = 0;
            $("#telephonyModel").change();
            countriesAndCarriers = [];
            $("#byocCloudCarriers").empty();
            $("#phoneNumbersDeployment").val('');
            $("#relationshipWithCarrier").prop('checked', false);
            $("#customerResourceCommitted").prop('checked', false);
            $("#hyperVEnvironment").prop('checked', false);

            // General Configuration
            $("#numberConcurrentCalls").val('');
            $("#callFlowsDocumented").prop('checked', false);
            $("#emailFlowDocumented").prop('checked', false);
            $("#promptsAvailable").prop('checked', false);
            $("#identificationAndVerificationProcesses").val('');
            $("#itInfrastructure").val('');
            $("#networkAssessmentTool").prop('checked', false);
            $("#usersInternetBandwidth").prop('checked', false);
            $("#endUserDevicesRequireVPN").prop('checked', false);
            $("#virtualDesktopSolution").val('');
            $("#emailInfrastructure").val('');

            // Policies & Processes
            $("#standardTermsConditions").prop('checked', false);
            $("#offBoardingPolicy").prop('checked', false);
            $("#changeManagementProcessDelays").prop('checked', false);

            // Your Info
            $("#region").val('');
            $("#subRegion").empty();
            $("<option selected disabled />", { value: "Select a Sub-Region" }).text("Select a Sub-Region").appendTo("#subRegion");
            $("#requesterName").val(userInfo.name);
            $("#requesterEmail").val(userInfo.mail);
            $("#requesterPhoneNumber").val(userInfo.phone);
            $("#datepicker").val('');
            $("#notes").val('');
            $("#partnerCustomerName").val('');
            $("#salesforceAccountOpportunity").val('');

            localStorage.removeItem("rapidForm_draft");
        }

        setInterval(() => {            
            try {
                let data = {
                    countriesAgents: $("#countriesAgents").val(),
                    countriesOperation: $("#countriesOperation").val(),

                    // Telephony
                    existingTelephonyUsage: $("#existingTelephonyUsage").is(':checked'),
                    telephonyModel: $("#telephonyModel").val(),
                    byocCloudCarriers: countriesAndCarriers,
                    relationshipWithCarrier: $("#relationshipWithCarrier").is(':checked'),
                    customerResourceCommitted: $("#customerResourceCommitted").is(':checked'),
                    hyperVEnvironment: $("#hyperVEnvironment").is(':checked'),

                    // Common Questions
                    numberConcurrentCalls: $("#numberConcurrentCalls").val(),
                    callFlowsDocumented: $("#callFlowsDocumented").is(':checked'),
                    emailFlowDocumented: $("#emailFlowDocumented").is(':checked'),
                    promptsAvailable: $("#promptsAvailable").is(':checked'),
                    identificationAndVerificationProcesses: $("#identificationAndVerificationProcesses").val(),
                    itInfrastructure: $("#itInfrastructure").val(),
                    networkAssessmentTool: $("#networkAssessmentTool").is(':checked'),
                    usersInternetBandwidth: $("#usersInternetBandwidth").is(':checked'),
                    endUserDevicesRequireVPN: $("#endUserDevicesRequireVPN").is(':checked'),
                    virtualDesktopSolution: $("#virtualDesktopSolution").val(),

                    // Policies & Processes
                    standardTermsConditions: $("#standardTermsConditions").is(':checked'),
                    offBoardingPolicy: $("#offBoardingPolicy").is(':checked'),
                    changeManagementProcessDelays: $("#changeManagementProcessDelays").is(':checked'),

                    // Your info
                    region: $("#region").val(),
                    subRegion: $("#subRegion").val(),
                    requesterName: $("#requesterName").val(),
                    requesterEmail: $("#requesterEmail").val(),
                    requesterPhoneNumber: $("#requesterPhoneNumber").val(),
                    notes: $("#notes").val(),
                    partnerCustomerName: $("#partnerCustomerName").val(),

                    // Optional Fields
                    salesforceAccountOpportunity: $("#salesforceAccountOpportunity").val(),
                    phoneNumbersDeployment: $("#phoneNumbersDeployment").val(),
                    newNumbers: $("#newNumbers").val(),
                    existingTelephonyUsageDetails: $("#existingTelephonyUsageDetails").val(),
                    emailInfrastructure: $("#emailInfrastructure").val()

                }

                let needCompletedByDate = moment($("#datepicker").datepicker('getDate')).format("YYYY-MM-DDT00:00:00.000") + "Z";
                if (needCompletedByDate != "Invalid date") {
                    data.needCompletedBy = needCompletedByDate;
                }
                localStorage.setItem("rapidForm_draft", JSON.stringify(data));
            } catch (error) {
                console.error(error);
            }
        }, 10000
        );

        function loadDraft() {
            console.log('loadDraft()');
            try {
                let data = JSON.parse(localStorage.getItem("rapidForm_draft"));
                if (!data) {
                    console.log('no draft found.');
                    return
                }

                // Telephony
                if (data.countriesAgents) {
                    $("#countriesAgents").val(data.countriesAgents);
                    $("#countriesAgents").selectpicker('refresh');
                }
                if (data.countriesOperation) {
                    $("#countriesOperation").val(data.countriesOperation);
                    $("#countriesOperation").selectpicker('refresh');
                }

                $("#existingTelephonyUsage").attr('checked', data.existingTelephonyUsage);
                $("#existingTelephonyUsageDetails").attr('disabled', !data.existingTelephonyUsage);
                $("#existingTelephonyUsageDetails").val(data.existingTelephonyUsageDetails);
                countriesAndCarriers = data.byocCloudCarriers;
                if (data.telephonyModel) {
                    $("#telephonyModel").val(data.telephonyModel);
                    $("#telephonyModel").change();
                }

                $("#phoneNumbersDeployment").val(data.phoneNumbersDeployment);
                $("#relationshipWithCarrier").prop('checked', data.relationshipWithCarrier);
                $("#customerResourceCommitted").prop('checked', data.customerResourceCommitted);
                $("#hyperVEnvironment").prop('checked', data.hyperVEnvironment);

                // General Configuration
                $("#numberConcurrentCalls").val(data.numberConcurrentCalls);
                $("#callFlowsDocumented").prop('checked', data.callFlowsDocumented);
                $("#emailFlowDocumented").prop('checked', data.emailFlowDocumented);
                $("#promptsAvailable").prop('checked', data.promptsAvailable);
                $("#identificationAndVerificationProcesses").val(data.identificationAndVerificationProcesses);
                $("#itInfrastructure").val(data.itInfrastructure);
                $("#networkAssessmentTool").prop('checked', data.networkAssessmentTool);
                $("#usersInternetBandwidth").prop('checked', data.usersInternetBandwidth);
                $("#endUserDevicesRequireVPN").prop('checked', data.endUserDevicesRequireVPN);
                $("#virtualDesktopSolution").val(data.virtualDesktopSolution);
                $("#emailInfrastructure").val(data.emailInfrastructure);

                // Policies & Processes
                $("#standardTermsConditions").prop('checked', data.standardTermsConditions);
                $("#offBoardingPolicy").prop('checked', data.offBoardingPolicy);
                $("#changeManagementProcessDelays").prop('checked', data.changeManagementProcessDelays);

                // Your Info
                if (data.region) {
                    $("#region").val(data.region);
                    $("#region").change();
                }
                if (data.subRegion) 
                    $("#subRegion").val(data.subRegion);

                // Optional
                $("#requesterName").val(data.requesterName);
                $("#requesterEmail").val(data.requesterEmail);
                $("#requesterPhoneNumber").val(data.requesterPhoneNumber);
                $("#datepicker").datepicker('update', new Date(data.needCompletedBy));
                $("#notes").val(data.notes);
                $("#partnerCustomerName").val(data.partnerCustomerName);
                $("#salesforceAccountOpportunity").val(data.salesforceAccountOpportunity);
                $("#newNumbers").val(data.newNumbers);

            } catch (error) {
                console.error(error);
            }
        }

    </script>

    <!--Coollabs -->
    <script async defer src="https://cdn.coollabs.io/save.js"></script>

</body>

</html>