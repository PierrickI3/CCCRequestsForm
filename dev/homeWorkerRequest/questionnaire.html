<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
    <title>CC PS Questionnaire</title>
    <link rel="shortcut icon" href="/favicon.ico">
    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- Bootstrap DatePicker -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker3.min.css" integrity="sha256-FAOaXTpl90/K8cXmSdsskbQN3nKYulhCpPbcFzGTWKI=" crossorigin="anonymous" />
    <!-- jQuery Toast -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/jquery-toast-plugin/1.3.2/jquery.toast.min.css" rel="stylesheet">
    <!-- Bootstrap Select -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.9/dist/css/bootstrap-select.min.css">
    <!-- jQuery UI Theme -->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/flick/jquery-ui.css">
    <!-- JSGrid -->
    <link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jsgrid/1.5.3/jsgrid.min.css" />
    <link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jsgrid/1.5.3/jsgrid-theme.min.css" />
    <!-- Custom CSS -->
    <link rel="stylesheet" href="./css/ps_questionnaire.css">

</head>

<body>
    <img class="overlay" src="./images/devmode.png" id="devModeImage" hidden alt="devMode" />
    <nav class="navbar navbar-dark bg-dark">
        <a class="navbar-brand" href="#">
            <img src="images/genesys.png" width="30" height="30" class="d-inline-block align-top" alt="">
            <span class="badge badge-info mr-2">#ps</span>Rapid Response Questionnaire <small><span id="badgePill" class="badge badge-pill badge-warning"></span></small>
        </a>
        <ul class="mb-0">

            <ul class="nav navbar-nav" style="float: right;">
                <li><button id="exportCSV" href="#" class="btn btn-dark btn-sm ml-2" disabled>Generate CSV</button></li>
            </ul>

            <ul class="nav navbar-nav" style="float: right;">
                <li><button id="saveDraft" href="#" onclick="saveDraft();" class="btn btn-primary btn-sm ml-2" disabled>Save draft</button></li>
            </ul>


        </ul>

    </nav>

    <div class="alert alert-danger fade show" role="alert" id="alert" hidden>
        <strong>Maintenance Alert</strong> This site is being updated. Please wait.
        <a class="btn btn-light" href="#" onclick="location.reload();"><i class="fa fa-refresh"></i> Refresh</a>
    </div>

    <div class="container-fluid mt-4">
        <div class="form-row">
            <div class="form-group col-md-12">
                <div id="status">

                </div>
                <center>
                    <div id="spinner" class="justify-content-center">
                        <div class="spinner-grow text-secondary" role="status">
                        </div>
                        <br>
                        <p id="spinner_message" class="text-secondary">loading...</p>
                    </div>



                    <div id="accordion">
                        <div class="card" id="divRequestDetails" hidden>
                            <div class="card-header card-header-top" id="headingOne">
                                <h5 class="mb-0">
                                    <button class="btn btn-outline-success collapsed" data-toggle="collapse" data-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                                        Request details
                                    </button>
                                </h5>
                            </div>

                            <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordion">
                                <div class="card-body">
                                    <label id="requestDetails"></label>


                                </div>
                            </div>
                        </div>

                    </div>
                </center>

                <section id="mainForm" hidden>
                    <div class="row">
                        <div class="col-md-8 offset-md-2">
                            <div class="bd-example" data-example-id="">
                                <div id="accordion" role="tablist" aria-multiselectable="true">
                                    <div class="card">
                                        <div class="card-header shadow-lg" role="tab" id="headingOrgSetup">
                                            <div class="mb-0">
                                                <a data-toggle="collapse" data-parent="#accordion" href="#collapseOrg" aria-expanded="false" aria-controls="collapseOrg" class="collapsed">
                                                    <i class="fa fa-sitemap" aria-hidden="true" style="color: #FF4F1F;"></i>
                                                    <h3>Organization Setup</h3>
                                                    <p>First things first, let's define some basic information about the customer</p>
                                                </a>
                                                <i class="fa fa-angle-right" aria-hidden="true" style="color: #FF4F1F;"></i>
                                            </div>
                                        </div>

                                        <div id="collapseOrg" class="collapse" role="tabpanel" aria-labelledby="headingOrgSetup" aria-expanded="false">
                                            <div class="card-block">
                                                <div class="form-group row">
                                                    <label for="companyName" class="col-sm-2 col-form-label">Company Name</label>
                                                    <div class="col-sm-10">
                                                        <input type="text" class="form-control" id="companyName" name="companyName" placeholder="Enter the name of the company">
                                                    </div>
                                                </div>
                                                <div class="form-group row">
                                                    <label for="genesysCloudRegion" class="col-sm-2 col-form-label">Genesys Cloud Region</label>
                                                    <div class="col-sm-10">
                                                        <select class="custom-select" id="genesysCloudRegion" name="genesysCloudRegion">
                                                            <option selected disabled>Select a Genesys Cloud Region</option>
                                                            <optgroup label="North America">
                                                                <option value="cac1.pure.cloud" disabled>cac1.pure.cloud - Canada</option>
                                                                <option value="mypurecloud.com">mypurecloud.com - East</option>
                                                                <option value="usw2.pure.cloud">usw2.pure.cloud - West</option>
                                                            </optgroup>
                                                            <optgroup label="EMEA">
                                                                <option value="euw2.pure.cloud" disabled>euw2.pure.cloud - UK</option>
                                                                <option value="mypurecloud.de">mypurecloud.de - Frankfurt</option>
                                                                <option value="mypurecloud.ie">mypurecloud.ie - Ireland</option>
                                                            </optgroup>
                                                            <optgroup label="APAC">
                                                                <option value="apne2.pure.cloud" disabled>apne2.pure.cloud - Seoul </option>
                                                                <option value="mypurecloud.com.au">mypurecloud.com.au - Australia/New Zealand </option>
                                                                <option value="mypurecloud.jp">mypurecloud.jp - Japan </option>
                                                            </optgroup>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="form-group row">
                                                    <label for="numberOfUsers" class="col-sm-2 col-form-label">Number of Users</label>
                                                    <div class="col-sm-10">
                                                        <input type="number" class="form-control" id="numberOfUsers" name="numberOfUsers" placeholder="Enter the number of users">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card">
                                        <div class="card-header shadow-lg" role="tab" id="headingLocations">
                                            <div class="mb-0">
                                                <a data-toggle="collapse" data-parent="#accordion" href="#collapseLocations" aria-expanded="false" aria-controls="collapseLocations" class="collapsed">
                                                    <i class="fa fa-globe" aria-hidden="true" style="color: #FF4F1F;"></i>
                                                    <h3>Locations</h3>
                                                    <p>Information about each location</p>
                                                </a>
                                                <i class="fa fa-angle-right" aria-hidden="true" style="color: #FF4F1F;"></i>
                                            </div>
                                        </div>

                                        <div id="collapseLocations" class="collapse" role="tabpanel" aria-labelledby="headingLocations" aria-expanded="false">
                                            <div class="card-block">
                                                <button id="addLocation" class="btn btn-primary" type="button"><i class="fa fa-plus"></i> Add</button>
                                                <div id="jsGrid"></div>

                                                <div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-hidden="true">
                                                    <div class="modal-dialog modal-lg" role="document">
                                                        <div class="modal-content">
                                                            <div class="modal-header" id="modal-header">
                                                                <h5 id="title" class="modal-title">New Location</h5>
                                                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                    <span aria-hidden="true">&times;</span>
                                                                </button>
                                                            </div>
                                                            <form class="modal-body form-horizontal" id="modal-form">
                                                                <div class="form-group">

                                                                    <div class="form-group row">
                                                                        <label for="locationName" class="col-sm-3 col-form-label">Location Name</label>
                                                                        <div class="col-sm-9">
                                                                            <input type="text" class="form-control" id="locationName" name="locationName" placeholder="Enter the name of this location" required>
                                                                        </div>
                                                                    </div>

                                                                    <div class="form-group row">
                                                                        <label for="streetAddress" class="col-sm-3 col-form-label">Street Address</label>
                                                                        <div class="col-sm-9">
                                                                            <input type="text" class="form-control" id="streetAddress" name="streetAddress" placeholder="Enter the street address" required>
                                                                        </div>
                                                                    </div>

                                                                    <div class="form-group row">
                                                                        <label for="city" class="col-sm-3 col-form-label">City</label>
                                                                        <div class="col-sm-9">
                                                                            <input type="text" class="form-control" id="city" name="city" placeholder="Enter the name of the city for this location" required>
                                                                        </div>
                                                                    </div>

                                                                    <div class="form-group row">
                                                                        <label for="state" class="col-sm-3 col-form-label">State</label>
                                                                        <div class="col-sm-9">
                                                                            <input type="text" class="form-control" id="state" name="state" placeholder="(optional) Enter the name of the state for this location">
                                                                        </div>
                                                                    </div>

                                                                    <div class="form-group row">
                                                                        <label for="zipCode" class="col-sm-3 col-form-label">Zip Code</label>
                                                                        <div class="col-sm-9">
                                                                            <input type="text" class="form-control" id="zipCode" name="zipCode" placeholder="Enter the zip code for this location" required>
                                                                        </div>
                                                                    </div>

                                                                    <div class="form-group row">
                                                                        <label for="country" class="col-sm-3 col-form-label">Country</label>
                                                                        <div class="col-sm-9">
                                                                            <select class="selectpicker" id="country" name="country" class="form-control" required data-live-search="true">
                                                                            </select>
                                                                        </div>
                                                                    </div>

                                                                    <div class="form-group row">
                                                                        <label for="notes" class="col-sm-3 col-form-label">Notes</label>
                                                                        <div class="col-sm-9">
                                                                            <input type="text" class="form-control" id="notes" name="notes" placeholder="(optional) Describe the location (e.g. Main HQ)">
                                                                        </div>
                                                                    </div>

                                                                    <div class="form-group row">
                                                                        <label for="emergencyNumber" class="col-sm-3 col-form-label">Emergency Number</label>
                                                                        <div class="col-sm-9">
                                                                            <input type="text" class="form-control" id="emergencyNumber" name="emergencyNumber" placeholder="Enter the emergency phone number for this location" required>
                                                                        </div>
                                                                    </div>

                                                                    <div class="modal-footer">
                                                                        <button id="btnClose" type="button" class="btn btn-link pull-right" data-dismiss="modal">Close</button>
                                                                        <button id="submit" type="submit" class="btn btn-primary pull-left"><i class="fa fa-plus"></i> Add</button>
                                                                    </div>
                                                            </form>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>



    <noscript>You need to enable JavaScript to run this app.</noscript>
    <!--#region Imports -->
    <!-- Bootstrap core JavaScript-->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>
    <!-- Core plugin JavaScript-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>
    <!-- Moment.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js" integrity="sha256-4iQZ6BVL4qNKlQ27TExEhBN1HFPvAvAMbFavKKosSWQ=" crossorigin="anonymous"></script>
    <!-- Bootstrap DatePicker -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js" integrity="sha256-bqVeqGdJ7h/lYPq6xrPv/YGzMEb6dNxlfiTUHSgRCp8=" crossorigin="anonymous"></script>
    <!-- Genesys Cloud -->
    <script src="https://sdk-cdn.mypurecloud.com/javascript/61.0.0/purecloud-platform-client-v2.min.js"></script>
    <!-- JQuery Validate -->
    <script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.1/dist/jquery.validate.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.1/dist/additional-methods.min.js"></script>
    <!-- jQuery Toast -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-toast-plugin/1.3.2/jquery.toast.min.js"></script>
    <!-- jQuery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <!-- Bootstrap Select -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.9/dist/js/bootstrap-select.min.js"></script>
    <!-- JSGrid -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jsgrid/1.5.3/jsgrid.min.js"></script>
    <!-- Our Scripts -->
    <script src="js/gc.js"></script>
    <script src="js/requests.js"></script>
    <script src="js/tools.js"></script>
    <!-- Dictionary -->
    <script src="js/dictionary.js"></script>

    <!--#endregion -->

    <script>
        let gcToken, id, request, caItem;
        id = getUrlParameter("id");

        init();

        async function init() {
            console.log('function init');
            $('#spinner_message')[0].innerHTML = "login to Genesys Cloud...";

            $.each(countries, (i, country) => {
                $("<option/>", { value: country.name }).text(country.name).appendTo("#country");
            });

            document.getElementById("spinner").style.display = "block";
            try {
                await getMe();
                if (!maintenanceMode) $("#submit").attr('disabled', false);
            } catch (error) {
                console.error(error);
                showMessage(error.hasOwnProperty('message') ? error.message : `Unable to login to Genesys Cloud ${JSON.stringify(error)}`, true);
                return
            } finally {
                document.getElementById("spinner").style.display = "none";
            }

            gcToken = userInfo.token
            localStorage.setItem("gcToken", gcToken);
            localStorage.setItem("userName", userInfo.name);

            if (id) {
                console.log(`found id ${id} in path, check for rapidRequest and draft version...`);
                document.getElementById("spinner").style.display = "block";
                // Try to load #rapidresponse request
                try {
                    $('#spinner_message')[0].innerHTML = "Validating Id...";
                    request = await getRequest(id);
                    console.log(request);
                    $('#badgePill')[0].innerHTML = "1"
                    console.log(request);
                    $('#requestDetails')[0].innerHTML = `Related to Partner/Customer Name <B>${request.partnerCustomerName}</B> requested by <em>${request.requesterName}</em>`;
                } catch (error) {
                    console.error(error);
                    if (error.status !== 404) {
                        document.getElementById("spinner").style.display = "none";
                        showMessage(JSON.stringify(error), true);
                        return
                    }
                }

                // Try to load latest draft
                try {
                    $('#spinner_message')[0].innerHTML = "check for latest draft...";
                    console.log('check for draft questionnaire...');
                    caItem = await ca_getItem(id);
                    console.log(caItem);
                } catch (error) {
                    console.log(error);
                    if (error.status !== 404) {
                        document.getElementById("spinner").style.display = "none";
                        showMessage(JSON.stringify(error), true);
                        return
                    }
                }
                document.getElementById("spinner").style.display = "none";

                if (!request && !caItem) {
                    showMessage("Provided requestId doesn't exist", true);
                    return
                }
                if (request || caItem) {
                    loadDraftConfiguration();
                    enableForm(true);
                }

            } else {
                // New not related RequestForm                
                $('#badgePill')[0].innerHTML = "NEW";
                enableForm(true);
            }
        }

        function enableForm(_bool) {
            $("#saveDraft").prop('disabled', !_bool);
            $("#exportCSV").prop('disabled', !_bool);
            $("#mainForm").attr("hidden", !_bool);
            if (request)
                $("#divRequestDetails").attr("hidden", !_bool);
        }

        function loadDraftConfiguration() {
            console.log('function loadDraftConfiguration');
            if (caItem) {
                // organization
                $('#companyName').val(caItem.organizationSetup.companyName);
                $('#genesysCloudRegion').val(caItem.organizationSetup.genesysCloudRegion);
                $('#numberOfUsers').val(caItem.organizationSetup.numberOfUsers);
            }
        }

        function buildJSON() {
            console.log('function buildJSON');
            let json = {
                organization: {},
                locations: []
            };

            if ($('#companyName').val())
                json.organization.companyName = $('#companyName').val();
            if ($('#genesysCloudRegion').val())
                json.organization.genesysCloudRegion = $('#genesysCloudRegion').val();
            if ($('#numberOfUsers').val())
                json.organization.numberOfUsers = $('#numberOfUsers').val();
            console.log(json);

            // Test Obj
            json = {
                organizationSetup: {
                    companyName: "Test Company",
                    genesysCloudRegion: "mypurecloud.ie",
                    numberOfUsers: 500
                },
                locations: [
                    {
                        locationName: "Some location name",
                        streetAddress: "555 North St.",
                        city: "Indianapolis",
                        state: "Indiana",
                        zipCode: "433377",
                        countryAbbreviation: "US",
                        country: "United States",
                        notes: "Main HQ",
                        emergencyNumber: "+13174444444"
                    },
                    {
                        locationName: "Some location name #2",
                        streetAddress: "555 North St. #2",
                        city: "Indianapolis #2",
                        state: "Indiana #2",
                        zipCode: "433377 #2",
                        countryAbbreviation: "US #2",
                        country: "United States #2",
                        notes: "Main HQ #2",
                        emergencyNumber: "+13174444444 #2"
                    }
                ]
            }
            return json
        }

        //#region JSGrid

        let validator = $("#editModal #modal-form").validate({
            errorClass: "text-danger",
            successClass: "test-success"
        });

        var db = {
            loadData: function (filter) {
                return $.grep(caItem.locations, function (location) {
                    return (!filter.Name || location.Name.indexOf(filter.Name) > -1)
                        && (filter.Age === undefined || location.Age === filter.Age)
                        && (!filter.Address || location.Address.indexOf(filter.Address) > -1)
                        && (!filter.Country || location.Country === filter.Country)
                        && (filter.Married === undefined || location.Married === filter.Married);
                });
            },

            insertItem: function (insertingLocation) {
                this.locations.push(insertingLocation);
            },

            updateItem: function (updatingLocation) { },

            deleteItem: function (deletingLocation) {
                var locationIndex = $.inArray(deletingLocation, this.locations);
                this.locations.splice(locationIndex, 1);
            }
        };

        window.db = db;

        async function saveDraft() {
            console.log('saveDraft()');

            try {
                let json = buildJSON();
                if (caItem) {
                    await ca_updateItem(caItem.id, json);
                } else {
                    caItem = await ca_createItem(json);
                    console.log(`responseId created on CA db: ${caItem.id}`);
                    window.history.pushState('', 'CC Rapid Response Request Form', `${window.location.href}?id=${caItem.id}`);

                }
            } catch (error) {
                console.error(error);
                showMessage("Failed to update draft item", JSON.stringify(error));
                return
            }

            showMessage("Draft updated", false);
        }

        $("#addLocation").on('click', (e) => {
            e.preventDefault();
            showDetailsDialog();
        });

        function populateLocations() {
            console.log('caItem locations:', caItem.locations);
            db.locations = caItem.locations;

            $("#jsGrid").jsGrid({
                height: "100vh",
                width: "100%",
                editing: true,
                autoload: true,
                paging: false,
                deleteConfirm: function (item) {
                    return "The location \"" + item.locationName + "\" will be removed. Are you sure?";
                },
                rowClick: function (args) {
                    showDetailsDialog(args.item);
                },
                controller: db,
                fields: [
                    { name: "locationName", title: "Name", type: "text" },
                    { name: "streetAddress", title: "Street Address", type: "text" },
                    { name: "city", title: "City", type: "text" },
                    { name: "state", title: "State", type: "text" },
                    { name: "zipCode", title: "Zip Code", type: "text" },
                    { name: "country", title: "Country", type: "text" },
                    { name: "notes", title: "Notes", type: "text" },
                    { name: "emergencyNumber", title: "Emergency #", type: "text", width: 120 },
                    { type: "control", modeSwitchButton: false, editButton: false, width: 68 }
                ]
            });
        }

        var formSubmitHandler = $.noop;

        var showDetailsDialog = function (item) {
            if (item) {
                $("#editModal #locationName").val(item.locationName);
                $("#editModal #streetAddress").val(item.streetAddress);
                $("#editModal #city").val(item.city);
                $("#editModal #state").val(item.state);
                $("#editModal #zipCode").val(item.zipCode);
                $("#editModal #country").val(item.country);
                $("#editModal #country").selectpicker('refresh');
                $("#editModal #notes").val(item.notes);
                $("#editModal #emergencyNumber").val(item.emergencyNumber);
                $("#editModal #submit").html("<i class='fa fa-floppy-o'></i> Save");
                $("#editModal #modal-form").on('submit', (e) => {
                    e.preventDefault();
                    if (!$("#modal-form").valid()) { return; }
                    saveItem(item, false);
                    $("#editModal").modal('hide');
                });
            } else {
                $("#editModal #modal-form").on('submit', (e) => {
                    e.preventDefault();
                    if (!$("#modal-form").valid()) { return; }
                    saveItem(item, true);
                    $("#editModal").modal('hide');
                });
            }
            $("#editModal").modal('show');
        };

        var saveItem = function (item, isNew) {
            $.extend(item, {
                locationName: $("#editModal #locationName").val(),
                streetAddress: $("#editModal #streetAddress").val(),
                city: $("#editModal #city").val(),
                state: $("#editModal #state").val() || "N/A",
                zipCode: $("#editModal #zipCode").val(),
                country: $("#editModal #country").val(),
                notes: $("#editModal #notes").val() || "N/A",
                emergencyNumber: $("#editModal #emergencyNumber").val(),
            });
            $("#jsGrid").jsGrid(isNew ? "insertItem" : "updateItem", item);
        };

        //#region Modal

        $('#editModal').on('hidden.bs.modal', async () => {
            initModal();
        });

        function initModal() {
            $("#editModal #locationName").val("");
            $("#editModal #streetAddress").val("");
            $("#editModal #city").val("");
            $("#editModal #state").val("");
            $("#editModal #zipCode").val("");
            $("#editModal #country").val("");
            $("#editModal #country").selectpicker('refresh');
            $("#editModal #notes").val("");
            $("#editModal #emergencyNumber").val("");
            $("#editModal #submit").html("<i class='fa fa-plus'></i> Add");

            validator.resetForm(); // Reset validation errors
        }

        //#endregion

        //#endregion

        function getUrlParameter(sParam) {
            var sPageURL = window.location.search.substring(1),
                sURLVariables = sPageURL.split('&'),
                sParameterName,
                i;

            for (i = 0; i < sURLVariables.length; i++) {
                sParameterName = sURLVariables[i].split('=');

                if (sParameterName[0] === sParam) {
                    return sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
                }
            }
        };

    </script>

    <!--Coollabs -->
    <script async defer src="https://cdn.coollabs.io/save.js"></script>

</body>

</html>