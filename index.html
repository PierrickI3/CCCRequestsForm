<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
    <title>CCC Request Form</title>
    <link rel="shortcut icon" href="/favicon.ico">
    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <!-- Bootstrap Date/Time Picker -->
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.0.1/css/tempusdominus-bootstrap-4.min.css" />
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body>

    <div class="container-fluid">

        <nav class="navbar navbar-light bg-light">
            <a class="navbar-brand" href="#">
                <img src="images/genesys.png" width="30" height="30" class="d-inline-block align-top" alt="">
                Cloud Competency Center Request Form
            </a>
            <a href="requests.html" class="admin btn btn-primary">Review Requests</a>
        </nav>
        <br>

        <div class="form-row">
            <div class="form-group col-sm-8">

                <form>
                    <div class="form-row">
                        <div class="form-group col-md-5">
                            <label for="region">Region</label>
                            <select id="region" class="form-control">
                                <option value="" disabled selected>Select a Region</option>
                                <option value="APAC">APAC</option>
                                <option value="EMEA">EMEA</option>
                                <option value="LATAM">LATAM</option>
                                <option value="NA">North America</option>
                            </select>
                        </div>
                        <div class="form-group col-md-5">
                            <label for="subRegion">Sub-Region</label>
                            <select id="subRegion" class="form-control">
                                <option value="" disabled selected>Select a Sub-Region</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-5">
                            <label for="product">Product</label>
                            <select id="product" class="form-control">
                                <option value="" disabled selected>Select a Product</option>
                                <option value="Genesys Cloud">Genesys Cloud</option>
                                <option value="Genesys Engage">Genesys Engage</option>
                                <option value="Genesys Engage Cloud">Genesys Engage Cloud</option>
                                <option value="PureConnect">PureConnect</option>
                            </select>
                        </div>
                        <div class="form-group col-md-5">
                            <label for="requestType">Request Type</label>
                            <select id="requestType" class="form-control">
                                <option value="" disabled selected>Select a Request Type</option>
                                <option value="Additional Privacy Support">Additional Privacy Support</option>
                                <option value="Additional Security Support">Additional Security Support</option>
                                <option value="Associate SC & AE Enablement">Associate SC & AE Enablement</option>
                                <option value="Cloud Migrations">Cloud Migrations</option>
                                <option value="Critical Situation Management">Critical Situation Management</option>
                                <option value="End to End Partner Enablement">End to End Partner Enablement</option>
                                <option value="Innovation (Custom Demos, Integrations, Beta Testing)">Innovation (Custom
                                    Demos,
                                    Integrations, Beta Testing)</option>
                                <option value="Must Win/Strategic Opportunity Support">Must Win/Strategic Opportunity
                                    Support
                                </option>
                                <option value="Partner Enablement">Partner Enablement (Summits/Events/Webinars)</option>
                                <option value="POCs & Pilots for Strategic Opportunities">POCs & Pilots for Strategic
                                    Opportunities</option>
                                <option value="Technical Design/Architecture Review">Technical Design/Architecture
                                    Review
                                </option>
                                <option value="Test Drive">Test Drive</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-5">
                            <label for="requesterName">Requester Name</label>
                            <input type="text" class="form-control" id="requesterName" placeholder="Your Name">
                        </div>
                        <div class="form-group col-md-5">
                            <label for="requesterEmail">Requester Email</label>
                            <input type="text" class="form-control" id="requesterEmail"
                                placeholder="Your Email Address">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-5">
                            <label for="requesterPhoneNumber">Requester Phone #</label>
                            <input type="text" class="form-control" id="requesterPhoneNumber"
                                placeholder="Your Phone Number">
                        </div>
                        <div class="form-group col-md-5">
                            <label for="datetimepicker1">Need Completed By</label>
                            <div class="input-group date" id="datetimepicker1" data-target-input="nearest">
                                <input type="text" class="form-control datetimepicker-input"
                                    data-target="#datetimepicker1" />
                                <div class="input-group-append" data-target="#datetimepicker1"
                                    data-toggle="datetimepicker">
                                    <div class="input-group-text"><em class="fa fa-calendar"></em></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-10">
                            <label for="description">Description</label>
                            <textarea class="form-control" id="description"
                                placeholder="Describe your request"></textarea>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-10">
                            <label for="partnerCustomerName">Partner and/or Customer Name</label>
                            <input type="text" class="form-control" id="partnerCustomerName"
                                placeholder="Partner and/or Customer Name">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-10">
                            <label for="salesforceAccountOpportunity">Salesforce Account / Opportunity URL</label>
                            <input type="text" class="form-control" id="salesforceAccountOpportunity"
                                placeholder="Link to Salesforce opportunity or account">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-10">
                            <label for="fileAttachments">File Attachments</label>
                            <div class="custom-file">
                                <input type="file" class="custom-file-input" id="fileAttachments">
                                <label class="custom-file-label" for="fileAttachments">Choose file</label>
                            </div>
                        </div>
                    </div>
                    <!-- <div class="admin">
                <div class="form-row">
                    <div class="form-group col-md-2">
                        <label for="priority">Priority</label>
                        <select id="priority" class="form-control">
                            <option value="" disabled selected>Select a Priority</option>
                            <option value="Low">Low</option>
                            <option value="Medium">Medium</option>
                            <option value="High">Hig</option>
                        </select>
                    </div>
                    <div class="form-group col-md-4">
                        <label for="acceptedRejected">Accepted/Rejected</label>
                        <select id="acceptedRejected" class="form-control">
                            <option value="" disabled selected>Accepted or Rejected?</option>
                            <option value="Accepted">Accepted</option>
                            <option value="Rejected">Rejected</option>
                        </select>
                    </div>
                    <div class="form-group col-md-3">
                        <label for="datetimepicker2">Accepted/Rejected Date</label>
                        <div class="input-group date" id="datetimepicker2" data-target-input="nearest">
                            <input type="text" class="form-control datetimepicker-input" data-target="#datetimepicker2" />
                            <div class="input-group-append" data-target="#datetimepicker2" data-toggle="datetimepicker">
                                <div class="input-group-text"><em class="fa fa-calendar"></em></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group col-md-3">
                        <label for="status">Status</label>
                        <select id="status" class="form-control">
                            <option value="" disabled selected>Select a Status</option>
                            <option value="Accepted">Open</option>
                            <option value="On Hold">On Hold</option>
                            <option value="Waiting on Additional Information">Waiting on Additional Information</option>
                            <option value="Closed">Closed</option>
                        </select>
                    </div>
                </div>
            </div> -->

                </form>

                <br>
                <button type="submit" id="submit" class="btn btn-primary">Submit</button>


            </div>
            <div class="form-group col-sm-4">
                
                Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
            </div>
        </div>
    </div>


    <noscript>You need to enable JavaScript to run this app.</noscript>
    <!-- Bootstrap core JavaScript-->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>
    <!-- Core plugin JavaScript-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>
    <!-- Moment.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"
        integrity="sha256-4iQZ6BVL4qNKlQ27TExEhBN1HFPvAvAMbFavKKosSWQ=" crossorigin="anonymous"></script>
    <!-- Bootstrap Date/Time Picker -->
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.0.1/js/tempusdominus-bootstrap-4.min.js"></script>
    <!-- Genesys Cloud -->
    <script src="https://sdk-cdn.mypurecloud.com/javascript/61.0.0/purecloud-platform-client-v2.min.js"></script>
    <!-- Our Scripts -->
    <script src="js/gc.js"></script>
    <script src="js/requests.js"></script>

    <script>

        let regions = {
            APAC: [
                "Asia", "Australia", "New Zeland"
            ],
            EMEA: [
                "Central", "North", "South"
            ],
            LATAM: [
                "Andean", "Brazil", "Mexico", "Southern-Cone"
            ],
            NA: [
                "Central", "Eastern", "Western"
            ]
        }

        let adminGroups = [
            "4bfbc98d-35d6-4a85-85f9-4e661c1a32c0"
        ]

        $(function () {
            $("#datetimepicker1").datetimepicker({
                format: 'L'
            });
            $("#datetimepicker2").datetimepicker({
                defaultDate: new Date(),
                format: 'L'
            });
        });

        init();
        async function init() {
            var userInfo = await getMe();

            // Populate user info
            $("#requesterName").val(userInfo.name);
            $("#requesterEmail").val(userInfo.mail);
            $("#requesterPhoneNumber").val(userInfo.phone);

            /* Don't disable controls at the moment
            if (userInfo.name) document.getElementById("requesterName").disabled = true;
            if (userInfo.mail) document.getElementById("requesterEmail").disabled = true;
            if (userInfo.phone) document.getElementById("requesterPhoneNumber").disabled = true;
            */

            // Show Admin fields?
            if (userInfo.groups.some(g => adminGroups.includes(g))) {
                $(".admin").show();
            } else {
                $(".admin").hide();
            }
        }

        $("#region").on("change", () => {
            $("#subRegion").empty();
            for (let subregion of regions[$("#region").val()]) {
                $("<option/>", { value: subregion }).text(subregion).appendTo("#subRegion");
            }
        });

        $('#fileAttachments').on('change', function () {
            //get the file name
            var fileName = $(this).val();
            var cleanFileName = fileName.replace('C:\\fakepath\\', " ");
            $(this).next('.custom-file-label').html(cleanFileName);
        })


        $("#submit").on("click", async (e) => {
            e.preventDefault();

            let region = $("#region").val();
            let subRegion = $("#subRegion").val();
            let product = $("#product").val();
            let requestType = $("#requestType").val();
            let requesterName = $("#requesterName").val();
            let requesterEmail = $("#requesterEmail").val();
            let requesterPhoneNumber = $("#requesterPhoneNumber").val();
            let needCompletedBy = new Date($("#datetimepicker1").data("datetimepicker").date());
            let description = $("#description").val();
            let partnerCustomerName = $("#partnerCustomerName").val();
            let salesforceAccountOpportunity = $("#salesforceAccountOpportunity").val();
            let fileAttachments = $("#fileAttachments").val();

            console.log(`Region: ${region}, subRegion: ${subRegion}, Product: ${product}, Request Type: ${requestType}, Requester Name: ${requesterName}, Requester Email: ${requesterEmail}, Requester Phone Number: ${requesterPhoneNumber}, Need Completed By: ${needCompletedBy}, Description: ${description}, Partner or Customer Name: ${partnerCustomerName}, Salesforce Opportunity: ${salesforceAccountOpportunity}, File Attachments: ${fileAttachments}`);

            try {
                await postRequests(region, subRegion, product, requestType, requesterName, requesterEmail, requesterPhoneNumber, needCompletedBy, description, partnerCustomerName, salesforceAccountOpportunity, fileAttachments);
                console.log('Success!');
            } catch (error) {
                console.error(error);
            }
        });

    </script>

</body>

</html>